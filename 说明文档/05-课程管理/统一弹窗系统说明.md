# 🎨 统一弹窗系统说明

## 概述

系统已将所有浏览器原生弹窗（`alert`、`confirm`）替换为美观的自定义模态框，提供更好的用户体验。

## 🎭 弹窗类型

### 1. 提示框 (Alert)

用于显示信息、成功、警告或错误消息。

#### 类型与图标

| 类型 | 图标 | 颜色渐变 | 使用场景 |
|------|------|---------|---------|
| `info` | ℹ️ | 紫色渐变 | 一般提示信息 |
| `success` | ✓ | 绿色渐变 | 操作成功 |
| `warning` | ⚠️ | 粉红渐变 | 警告信息 |
| `error` | ✗ | 橙红渐变 | 错误信息 |

#### 调用方法

```javascript
// 基本用法
customAlert('这是一条提示消息');

// 完整用法
customAlert('操作成功！', '成功', 'success');
customAlert('请填写必填字段', '提示', 'warning');
customAlert('操作失败', '错误', 'error');
customAlert('这是一般信息', '提示', 'info');
```

#### 参数说明

```javascript
customAlert(message, title, type)
```

- `message` (必填): 提示内容，支持换行符 `\n`
- `title` (可选): 标题，默认 "提示"
- `type` (可选): 类型，默认 "info"
  - `'info'` - 一般信息
  - `'success'` - 成功
  - `'warning'` - 警告
  - `'error'` - 错误

### 2. 确认框 (Confirm)

用于需要用户确认的操作。

#### 调用方法

```javascript
// 基本用法（异步）
if (await customConfirm('确定要删除吗？')) {
    // 用户点击了"确定"
    console.log('用户确认删除');
} else {
    // 用户点击了"取消"
    console.log('用户取消操作');
}

// 带标题
if (await customConfirm('确定要删除这节课吗？', '确认删除')) {
    // 执行删除操作
}
```

#### 参数说明

```javascript
customConfirm(message, title)
```

- `message` (必填): 确认内容，支持换行符 `\n`
- `title` (可选): 标题，默认 "确认操作"
- **返回值**: `Promise<boolean>`
  - `true` - 用户点击"确定"
  - `false` - 用户点击"取消"

## 🎨 视觉特点

### 设计元素

1. **圆形图标**
   - 64x64像素
   - 渐变色背景
   - 白色图标

2. **动画效果**
   - 背景淡入（0.2秒）
   - 对话框下滑（0.3秒）
   - 背景模糊效果

3. **圆角设计**
   - 对话框圆角：20px
   - 按钮圆角：12px
   - 现代化风格

4. **阴影效果**
   - 对话框投影：0 10px 40px rgba(0,0,0,0.2)
   - 悬停按钮投影加强

### 颜色系统

```css
/* 信息 (Info) */
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

/* 成功 (Success) */
background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);

/* 警告 (Warning) */
background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);

/* 错误 (Error) */
background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);

/* 确认 (Confirm) */
background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
```

## 📦 使用示例

### 示例1：成功提示

```javascript
// 新增课程成功
customAlert('新增成功！', '成功', 'success');
```

显示效果：
```
┌─────────────────────────┐
│          ✓             │
│         成功            │
├─────────────────────────┤
│      新增成功！         │
├─────────────────────────┤
│      [ 确定 ]          │
└─────────────────────────┘
```

### 示例2：警告提示

```javascript
// 未填写必填字段
customAlert('请填写课程名称', '提示', 'warning');
```

### 示例3：错误提示

```javascript
// 操作失败
customAlert('保存失败：' + error.message, '错误', 'error');
```

### 示例4：确认删除

```javascript
// 删除确认
async function deleteItem() {
    if (await customConfirm('确定要删除这节课吗？', '确认删除')) {
        // 执行删除
        await api('/api/delete', 'DELETE');
        customAlert('删除成功！', '成功', 'success');
    }
}
```

### 示例5：多行内容

```javascript
// 智能排课确认
const message = `智能排课将为选中的课程安排20周课表。

注意：这将在现有课表基础上添加新的课程安排。

是否继续？`;

if (await customConfirm(message, '确认智能排课')) {
    // 执行排课
}
```

## 🔄 替换对照表

### Alert 替换

| 原代码 | 新代码 |
|--------|--------|
| `alert('提示消息')` | `customAlert('提示消息')` |
| `alert('成功')` | `customAlert('成功', '成功', 'success')` |
| `alert('错误')` | `customAlert('错误', '错误', 'error')` |

### Confirm 替换

| 原代码 | 新代码 |
|--------|--------|
| `if (confirm('确认?'))` | `if (await customConfirm('确认?'))` |
| `if (!confirm('确认?')) return` | `if (!await customConfirm('确认?')) return` |

**注意**：使用 `customConfirm` 的函数必须是 `async` 函数！

## 🎯 已替换的弹窗

课程管理系统中已替换的弹窗：

### 提示类 (Alert)
✅ 新增课程成功/失败
✅ 编辑课程成功/失败
✅ 删除课程失败
✅ 排课验证提示
✅ 智能排课结果
✅ 冲突检测结果
✅ 自动优化结果
✅ 所有错误提示

### 确认类 (Confirm)
✅ 删除课程确认
✅ 删除课表课程确认
✅ 智能排课确认
✅ 自动优化确认

## 🔧 技术实现

### HTML 结构

```html
<!-- 提示框 -->
<div class="custom-modal" id="customAlert">
    <div class="custom-modal-backdrop"></div>
    <div class="custom-modal-dialog">
        <div class="custom-modal-content">
            <div class="custom-modal-header">
                <div class="custom-modal-icon"></div>
                <h5 class="custom-modal-title"></h5>
            </div>
            <div class="custom-modal-body"></div>
            <div class="custom-modal-footer">
                <button>确定</button>
            </div>
        </div>
    </div>
</div>

<!-- 确认框 -->
<div class="custom-modal" id="customConfirm">
    <!-- 类似结构，但有两个按钮 -->
</div>
```

### JavaScript 核心代码

```javascript
// 提示框
function customAlert(message, title = '提示', type = 'info') {
    // 设置内容和样式
    // 显示模态框
}

// 确认框
function customConfirm(message, title = '确认操作') {
    return new Promise((resolve) => {
        // 设置内容
        // 绑定回调
        // 显示模态框
        // 用户点击后 resolve(true/false)
    });
}
```

## 💡 最佳实践

### 1. 选择合适的类型

```javascript
// ✅ 好的做法
customAlert('新增成功！', '成功', 'success');  // 成功用 success
customAlert('请填写必填字段', '提示', 'warning');  // 警告用 warning
customAlert('保存失败', '错误', 'error');  // 错误用 error

// ❌ 不好的做法
customAlert('新增成功！', '成功', 'error');  // 类型不匹配
```

### 2. 标题简洁明了

```javascript
// ✅ 好的做法
customAlert('操作成功！', '成功', 'success');

// ❌ 不好的做法
customAlert('操作成功！', '成功提示信息', 'success');  // 标题太长
```

### 3. 消息内容清晰

```javascript
// ✅ 好的做法
customAlert('请填写课程名称、选择教师', '提示', 'warning');

// ❌ 不好的做法
customAlert('错误', '错误', 'error');  // 消息不明确
```

### 4. 异步函数使用 await

```javascript
// ✅ 好的做法
async function deleteItem() {
    if (await customConfirm('确定删除？', '确认')) {
        // 执行删除
    }
}

// ❌ 不好的做法
function deleteItem() {  // 不是 async
    if (await customConfirm('确定删除？')) {  // 会报错
        // ...
    }
}
```

## 🎨 自定义样式

如果需要调整样式，修改 `templates/courses.html` 中的 CSS：

```css
/* 修改对话框大小 */
.custom-modal-dialog {
    max-width: 480px;  /* 调整这里 */
}

/* 修改图标大小 */
.custom-modal-icon {
    width: 64px;  /* 调整这里 */
    height: 64px;
}

/* 修改动画速度 */
@keyframes slideDown {
    /* 调整动画 */
}
```

## 📱 浏览器兼容性

✅ Chrome 60+
✅ Firefox 55+
✅ Safari 11+
✅ Edge 79+
✅ Opera 47+

不支持 IE 浏览器。

## 🔍 调试技巧

### 测试弹窗

在浏览器控制台测试：

```javascript
// 测试提示框
customAlert('测试消息', '测试', 'success');

// 测试确认框
customConfirm('确认测试？', '测试').then(result => {
    console.log('用户选择：', result);
});
```

### 检查元素

```javascript
// 检查弹窗是否存在
console.log(document.getElementById('customAlert'));
console.log(document.getElementById('customConfirm'));
```

## 🚀 未来计划

- [ ] 添加输入框类型弹窗 (Prompt)
- [ ] 支持自定义按钮文本
- [ ] 支持 HTML 内容
- [ ] 添加更多图标选择
- [ ] 支持位置调整（顶部/底部）
- [ ] 添加声音提示（可选）

## 📝 更新日志

### v1.0 (2025-12-09)
- ✅ 实现自定义 Alert 弹窗
- ✅ 实现自定义 Confirm 弹窗
- ✅ 替换所有浏览器原生弹窗
- ✅ 添加4种类型（info, success, warning, error）
- ✅ 添加动画效果
- ✅ 添加背景模糊

---

**注意**：旧的 `alert()` 和 `confirm()` 仍然可用，但强烈建议使用新的统一弹窗系统以获得更好的用户体验！

